[[{"l":"Overview"},{"i":"what-is-far-away-swap","l":"What is Far Away Swap?","p":["Far Away Swap is a decentralized exchange platform with integrated liquidity aggregator built on NEAR blockchain."]},{"i":"just-another-dex-not-were-better-see-why","l":"Just another DEX? Not we're better, see why:","p":["There are two key things to know about Far Away Swap:","we implement the new combined swap algorithm that increases the capital efficiency and consequently gives you more profit when you execute the swaps.","we aggregate liquidity of other leading DEXs of the ecosystem, trying to give you the best prices"]},{"l":"Main features"},{"i":"with-far-away-swap-you-can-do-financial-operations-like","l":"With Far Away Swap you can do financial operations like:","p":["Limit orders","Market orders","Provide liquidity in our pools"]},{"l":"Combined Swap Algorithm"},{"i":"how-it-works","l":"How it works?","p":["When swapping, one part of assets is being swapped in the order book and another part in the liquidity pool meaning one part of exchange is P2P."]},{"l":"Pool rate","p":["Which part of tokens is swapped in pool? It is always different. In next paragraphs we will call it\"pool rate\".","pool_rate = volume_swaped_in_pool / total_volume_of_swap","It depends on the total number of assets presented for the pair in both liquidity pool and order book. In order to choose the best pool rate, we will use a predictive model based on our researches."]},{"i":"why-do-we-need-it","l":"Why do we need it?","p":["Most DEX platforms use two models of exchange: automated market maker (AMM) and order book. Both models have some disadvantages","Illiquid market makes traders have difficulty in finding matching orders due to large bid-ask spread and low trading volumes. If you want to have successful orders, you have to make sure that your highest bid is lower than the lowest ask.","AMM causes high slippage for large orders: Slippage relies on the liquidity pool’s size of a certain trading pair. The liquidity pool needs to be 100x greater than the size of the order to keep the slippage rate under 1%","These problems could be solved by implementing both models at the same time(Combined Swap Algorithm) as their advantages perfectly complete their disadvantages ( check researches)."]}],[{"l":"Research","p":["$B reserves ≈ 215K, $A reserves ≈ 26M","As you can see, starting from 10'000 $A swapping, these charts all look like y = k/x^ n. This allows us to say that depending on liquidity in pool and order book, we will be able to predict the percentage of tokens we swap in pool due to mathematical model. In this case pool ratio calculation will have O(1)complexity.","As you could see previously, on all the ratio/swap amount curves we can apply a power trendline y = k/x^ n like here:","As you see, when we use combined swap, at one moment we reach a better price compared to order book and pool. Now let's talk about algorithms behind these simulations and how they could work in production.","combined swap","combined swap: we have pool reserves $A=M/2 and $B=N/2, and we use the same order book, but each $B amount is divided by 2","Depending on reserves in pool and order book data, the best ratio curve can take these forms.","For all the simulations we used a very simple python script that iterates trough all possible ratios and chooses the one who gives us the best $B amount out.","from order book only","from order book only: we use Binance's 98K limit sell orders when in total people sell N $B starting with token price = M/N","from pool only","from pool only: we have pool reserves $A=M and $B=N","Here is the chart explaining the price formation.","How do our pool works? Exactly the same as on Uniswap V2","Liquidity parameters in simulations:","Our goal is providing the best price by using combined swap. To prove the utility of these swaps, we present you our simulations of market price formation when buying in three different ways:","To make this very beautiful chart we had to simulate the one-moment abstract market state. On this market we have the total amount of $B = N and $A = M and 0.3% transaction fee. How did we estimate N and M constants? Easily, this data was downloaded and parsed from Binance, so once we reach their turnover, we know how to deal with it.","X-axis: total $A we are swapping.","Y-axis: percentage of $B we buy from pool","You can see that this algorithm is not efficient at all O(n) complexity and too much memory usage. However, in production we can avoid using it. How?"]}],[{"l":"Fees and profit"},{"l":"Fees","p":["When you swap your assets on Far Away, whether in an order book or in a liquidity pool, we take some swap fees.","Currently the maximum swap fee does not exceed 0.3% of swap volume","There are different type of fees:","transaction fee (almost negligible)","Far Away Swap","provider fee","protocol fee","Here are the explanations of fees for each type of swap you can execute on Far Away."]},{"l":"Liquidity Pool Swap Fees","p":["Far Away takes two types of fees in the liquidity pool:","0.3% provider fee that makes liquidity providers lock their assets in pool. In the future we are going to implement different provider fee levels but right now all liquidity pools have 0.3% fee","The total fee is:","fees = Provider Fee + Transaction Fee","It currently gives us 0.3% + negligible transaction fee for each pool swap."]},{"l":"Order Book Fees","p":["Order book has only one fee - Far Away Protocol Fee. So currently each order have a 0.1% fee on the transaction volume."]},{"l":"Combined Swap Fees","p":["In combined swap fee rate for a volume is always different. It depends on pool rate. However, it is not hard to calculate it. For example, if pool ratio = 20%, pool fee level = 0.3%, order book fee level = 0.1%, then your fee is","fee = 80% * SwapVolume * 0.1% + 20% * SwapVolume * 0.3%"]},{"l":"Liquidity providers profit","p":["All liquidity providers get profit, proportional to the liquidity put in a pool.","For example, if you add 50 $NEAR and 250 $USN in a liquidity pool, and after that, there are 500 $NEAR and 2500 $USN in total, then you owe 10% of pool's liquidity. Every time users swap their tokens in this pool (with 0.3% liquidity provider fee), as a liquidity provider, you get","profit = SwapVolume * 0.3% * 10%","However, this profit is put back to pool. You can pick it back on your wallet at every time.","If you want to become a liquidity provider, know that there are nevertheless some risks. One significant risk is impermanent loss, this is a great explanation of this concept by Binance Academy. Make sure to understand what impermanent loss is before provide your liquidity to pools."]}],[{"l":"Hackathon","p":["Far Away is born during a hackathon organized by NEAR protocol and Encode Club educational community in February/March 2022. We ended-up with a runner-up prize of $1500","You can see our first pitch here"]}]]